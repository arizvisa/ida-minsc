
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>2.5. Types in IDA &#8212; IDA-minsc  documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/sidebar.css" />
    <link rel="stylesheet" type="text/css" href="_static/content.css" />
    <link rel="stylesheet" type="text/css" href="_static/sidebar.css" />
    <link rel="stylesheet" type="text/css" href="_static/content.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Modules" href="modules.html" />
    <link rel="prev" title="2.4. Functional combinators" href="combinators.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="3. Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="combinators.html" title="2.4. Functional combinators"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">IDA-minsc  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="concepts.html" accesskey="U">2. Concepts</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="types-in-ida">
<span id="pythontyping-intro"></span><h1>2.5. Types in IDA<a class="headerlink" href="#types-in-ida" title="Permalink to this headline">¶</a></h1>
<p>In IDA, a core feature is the ability to apply types to either operands,
addresses, structure members, etc. This is a very powerful capability
and is one of the more important features of IDA Pro. By doing this,
this allows a reverse-engineer to identify the relationships between
the types used by instruction operands and global variables. This is
normally exposed to the user by various commands or hotkeys.</p>
<p>IDAPython and the IDA SDK expose an API to allow a user to programmatically
apply and retrieve type information from the various places a type might
have been applied to. There are a variety of functions that do this, and a
number of enumerations, flags, and constants that allow one to customize
their types.</p>
<p>Unfortunately, using these APIs is likely to get complex as one will
need to identify which function to use combined with determining which
constants or flags to represent the type they wish to apply.</p>
<p>This project attempts to simplify this by introducing a concept referred
to as “Pythonic” types. This is done by dual-using the semantics of the
types available in the Python language [<a class="reference internal" href="#pythontyping-references"><span class="std std-ref">1</span></a>]
to determine the correct constants and flags needed by IDA.</p>
<p class="rubric" id="pythontyping-references">References</p>
<ol class="arabic simple">
<li><a class="reference external" href="https://www.python.org/">The Python Programming Language</a></li>
</ol>
<div class="section" id="pythonic-types-format">
<span id="pythontyping-format"></span><h2>2.5.1. Pythonic types format<a class="headerlink" href="#pythonic-types-format" title="Permalink to this headline">¶</a></h2>
<p>There are a number of places within this project that allow a user to
display or apply a type. One such place where this is allowed is for
a structure member. Although structure members in IDA contain numerous
attributes, one of them is the type field which can be used to assign
a Pythonic type into.</p>
<p>As mentioned before, Pythonic types utilise the semantics of the more
commonly known types in Python in order to enable the user to view
or apply a type to a structure field or other receiver of a type. A
pythonic type is composed of what’s referred to as a container type,
and inside the container type is the element type.</p>
<div class="section" id="describing-the-container">
<h3>2.5.1.1. Describing the container<a class="headerlink" href="#describing-the-container" title="Permalink to this headline">¶</a></h3>
<p>There are two types of container types, these are the tuple which uses
“(” and “)” to group types, and the list which uses “[ and “]” to
group the type. A tuple is produces the semantics of an atomic type
and is just used to specify the size of the type. A list, however, is
used to describe an array and thus is used to specify the number of
elements in the array.</p>
<p>When grouping a Pythonic type with either of these, the first element is
always the type or class, and the second element is referred to as the
size or count. If neither of these container types are specified, then
the default size for the core type will be assumed.</p>
<p>A few examples of how to describe an atomic type for an imaginary type
<code class="xref py py-obj docutils literal notranslate"><span class="pre">t</span></code> can be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 3 bytes in size</span>
<span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># 8 bytes in size</span>
<span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">t</span>       <span class="c1"># 4 bytes on 32-bit architectures, 8 bytes on 64-bit</span>
</pre></div>
</div>
<p>A few examples of using a list to describe an array for an imaginary
type <code class="xref py py-obj docutils literal notranslate"><span class="pre">t</span></code> can be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>          <span class="c1"># 4 element array of a default sized &#39;t&#39;</span>
<span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">10</span><span class="p">]</span>    <span class="c1"># 10 element array of a &#39;t&#39; that is 2 bytes in size</span>
<span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[(</span><span class="n">t</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="mi">4</span><span class="p">]</span>     <span class="c1"># 4 element array of a &#39;t&#39; that is 8 bytes in size</span>
</pre></div>
</div>
</div>
<div class="section" id="describing-the-core-type">
<h3>2.5.1.2. Describing the core type<a class="headerlink" href="#describing-the-core-type" title="Permalink to this headline">¶</a></h3>
<p>The core type is considered an atomic type and is simply composed of various
keywords available in Python that are used to construct objects. It is important
to recognize that these are used literally as keywords and they’re not intended to
retain any kind of state.</p>
<p>Any one of the following Python types and functions can be used to represent a
type that will be transformed into IDA’s format.</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="5%" />
<col width="62%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">long</span></code></td>
<td>–</td>
<td>an integer type that uses types such as
<code class="docutils literal notranslate"><span class="pre">idaapi.FF_WORD</span></code>, <code class="docutils literal notranslate"><span class="pre">idaapi.FF_DWORD</span></code>, etc</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">chr</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></td>
<td>–</td>
<td>a character/string type that uses types such
<code class="docutils literal notranslate"><span class="pre">idaapi.FF_STRLIT</span></code>, etc</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></td>
<td>–</td>
<td>a floating point type which uses types such as
<code class="docutils literal notranslate"><span class="pre">idaapi.FF_FLOAT</span></code>, <code class="docutils literal notranslate"><span class="pre">idaapi.FF_DOUBLE</span></code>, etc</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code></td>
<td>–</td>
<td>a pointer type which uses <code class="docutils literal notranslate"><span class="pre">idaapi.FF_OFF*</span></code></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></td>
<td>–</td>
<td>an alignment type using <code class="docutils literal notranslate"><span class="pre">idaapi.FF_ALIGN</span></code></td>
</tr>
<tr class="row-even"><td><code class="xref py py-class docutils literal notranslate"><span class="pre">structure_t</span></code></td>
<td>–</td>
<td>a structure as retrieved by the
<a class="reference internal" href="modules/structure.html#module-structure" title="structure"><code class="xref py py-mod docutils literal notranslate"><span class="pre">structure</span></code></a> module using
<a class="reference internal" href="modules/structure.html#structure.by" title="structure.by"><code class="xref py py-func docutils literal notranslate"><span class="pre">structure.by()</span></code></a> or similar</td>
</tr>
</tbody>
</table>
<p>Using these common keywords as types allows one to not have to remember or
search through documentation for the correct flags to apply to IDA. For
most general purposes this should suffice.</p>
<p>However, if a user chooses to not use this interface, most of the functions
that take pythonic types are also capable of taking an integer. This integer
is the manually combined flags that represent an IDA type. It is however
suggested by the author that the users familiarize themselves with the way
that Pythonic types appear in order to comprehend some of the output of
functions that return their type in this format.</p>
</div>
</div>
<div class="section" id="examples">
<span id="pythontyping-examples-types"></span><h2>2.5.2. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>By using a container type combined with a core type, a vast number of IDA
types can be represented. This allows a user to quickly identify what type
is being represented without having to test any bits within the integer
representing the type. Some examples of describing an atomic type in this format
follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">(int,</span> <span class="pre">4)</span></code></td>
<td>A 4 byte sized integer (dword)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">(int,</span> <span class="pre">8)</span></code></td>
<td>A 2 byte sized integer (qword)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">(int,</span> <span class="pre">1)</span></code></td>
<td>A single byte sized integer (byte)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">(float,</span> <span class="pre">4)</span></code></td>
<td>A 4 byte sized floating point number (single)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">chr</span></code></td>
<td>A single byte sized character or string</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">int</span></code></td>
<td>A default sized integer (dword on 32-bit, qword on
64-bit)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">8)</span></code></td>
<td>An alignment to a multiple of 8</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">(str,</span> <span class="pre">10)</span></code> or
<code class="docutils literal notranslate"><span class="pre">(chr,</span> <span class="pre">10)</span></code></td>
<td>A 10 character string</td>
</tr>
</tbody>
</table>
<p>Some examples of using a list to describe an array of some particular element
can be:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">[(int,</span> <span class="pre">4),</span> <span class="pre">8]</span></code></td>
<td>An 8 element array of 4-byte integers or dwords</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">[float,</span> <span class="pre">32]</span></code></td>
<td>A 32 element array of default-sized floats</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">[str,</span> <span class="pre">256]</span></code></td>
<td>A 256-element string</td>
</tr>
</tbody>
</table>
<p>If a instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">structure_t</span></code> is desired to be used, this can be
treated as an atomic type. Usage of this, however, does not allow a user to
size the structure using the “(” and “)” grouping operators. This does, though,
allow a user to specify a <code class="xref py py-class docutils literal notranslate"><span class="pre">structure_t</span></code> as an array such as via
the following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">[mystruc,</span> <span class="pre">6]</span></code></td>
<td>if <code class="xref py py-obj docutils literal notranslate"><span class="pre">mystruc</span></code> is an instance of
<code class="xref py py-class docutils literal notranslate"><span class="pre">structure_t</span></code>, then this would represent
a 6 element array of that type</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">[mystruc,</span> <span class="pre">1]</span></code></td>
<td>A single element array of <code class="xref py py-obj docutils literal notranslate"><span class="pre">mystruc</span></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples-usage">
<span id="pythontyping-examples-usage"></span><h2>2.5.3. Examples – Usage<a class="headerlink" href="#examples-usage" title="Permalink to this headline">¶</a></h2>
<p>There are a number of places that Pythonic types are used, however the most
common place is within structure members via the <code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code> attribute.
The following examples will demonstrate how to use pythonic types against
a structure member.</p>
<p>First, a structure will need to be identified and then a member which contains
a type will need to be fetched:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">st</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;*mystruc*&#39;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">members</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>Output the type of the 4th member within the structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="nb">print</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span>
<span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>Modify the type of the 4th member to be the same number of bytes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">24</span><span class="p">]</span>     <span class="c1"># 6 * 4</span>
</pre></div>
</div>
<p>Shrink the member down to just a 16-bit integer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Change the member’s type into a particular <code class="xref py py-class docutils literal notranslate"><span class="pre">structure_t</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">st</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;*someotherstructure*&#39;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">st</span>
</pre></div>
</div>
<p>Modify the member’s type so that it represents a 6 element array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="p">[</span><span class="n">st</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>Modify the member’s type so that its a 3 element array of 8 byte floating point numbers (double):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">float</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div>
  <h3 class="sidebar">IDA-minsc</h3>
  <p class="sidebar logo">
    <a href="index.html">
      <img class="logo" src="_images/hamster.svg" alt="Logo"/>
    </a>
  </p>
</div>
  <h3 class="sidebar">Navigation</h3>
  <p class="topless">
    Next topic:
    <a href="modules.html" title="next chapter">3. Modules</a>
    <br />
    Previous topic:
    <a href="combinators.html" title="previous chapter">2.4. Functional combinators</a>
    <br />
  </p>
  <h3 class="sidebar"><a href="index.html">Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2.5. Types in IDA</a><ul>
<li><a class="reference internal" href="#pythonic-types-format">2.5.1. Pythonic types format</a><ul>
<li><a class="reference internal" href="#describing-the-container">2.5.1.1. Describing the container</a></li>
<li><a class="reference internal" href="#describing-the-core-type">2.5.1.2. Describing the core type</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">2.5.2. Examples</a></li>
<li><a class="reference internal" href="#examples-usage">2.5.3. Examples – Usage</a></li>
</ul>
</li>
</ul>

<h3 class="sidebar">Search</h3>
<div class="searchformwrapper">
  <form class="search" action="search.html" method="get">
    <input type="text" name="q" />
    <input type="submit" value="Go" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<div id="searchbox" role="search">
  <script type="text/javascript">$('#searchbox').show(0);</script>
</div><div class="remove-stupid-js-margin">
 <p>
   <h3 class="sidebar">Indices</h3>
   <ul>
     <li><a href="genindex.html">Index of Functions</a></li>
     <li><a href="py-modindex.html">Index of Modules</a></li>
   </ul>
 </p>
</div>
  <div role="note" aria-label="source link">
    <h3 class="sidebar">This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pythontyping.rst.txt" rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="3. Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="combinators.html" title="2.4. Functional combinators"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">IDA-minsc  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="concepts.html" >2. Concepts</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2022, Ali Rizvi-Santiago.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>