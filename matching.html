
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>2.3. Matching/Filtering of IDA types &#8212; IDA-minsc  documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/sidebar.css" />
    <link rel="stylesheet" type="text/css" href="_static/content.css" />
    <link rel="stylesheet" type="text/css" href="_static/sidebar.css" />
    <link rel="stylesheet" type="text/css" href="_static/content.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2.4. Functional combinators" href="combinators.html" />
    <link rel="prev" title="2.2. Tagging and the querying of the tag cache" href="tagging.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="combinators.html" title="2.4. Functional combinators"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tagging.html" title="2.2. Tagging and the querying of the tag cache"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">IDA-minsc  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="concepts.html" accesskey="U">2. Concepts</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="matching-filtering-of-ida-types">
<span id="matching-intro"></span><h1>2.3. Matching/Filtering of IDA types<a class="headerlink" href="#matching-filtering-of-ida-types" title="Permalink to this headline">¶</a></h1>
<p>IDA exposes a number of types as lists that can be viewed within a window.
Although these lists can be interacted with, the only way a user has to
filter them is via doing text searches and this is moreso used for
navigation. When interacting with these types programmatically, there are
a number of ways that a user can implement to filter or match them.</p>
<p>However, this requires the user to implement these methods themselves,
which can potentially require time searching through documentation
in order to identify the required functionality in order to extract the
required properties to filter said types.</p>
<p>This project actually implements a number of these filtering methods to
avoid the user having to implement this themselves. This is done by providing
what are known as <a class="reference internal" href="#matching-functions"><span class="std std-ref">Common matcher functions</span></a> for the various types that IDA exposes to
a user. These <a class="reference internal" href="#matching-functions"><span class="std std-ref">Common matcher functions</span></a> let a user provide a keyword argument describing
the method to filter with which will then be used to return the filtered types
to the user.</p>
<p>Some examples of the common keyword arguments that are provided are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="5%" />
<col width="67%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-data docutils literal notranslate"><span class="pre">address</span></code></td>
<td>–</td>
<td>Match according to an address.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></td>
<td>–</td>
<td>Match according to the exact name specified.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-data docutils literal notranslate"><span class="pre">like</span></code></td>
<td>–</td>
<td>Filter according to a glob being applied to a name</td>
</tr>
<tr class="row-even"><td><code class="xref py py-data docutils literal notranslate"><span class="pre">regex</span></code></td>
<td>–</td>
<td>Filter according to a regular-expression being
applied to a name.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-data docutils literal notranslate"><span class="pre">predicate</span></code></td>
<td>–</td>
<td>Filtering according to a callable that critiques
the type returning true or false.</td>
</tr>
</tbody>
</table>
<p>These keywords are then exposed to users via 3 general function styles. Each
matcher will typically provide functionality similar to the <a class="reference internal" href="#namespace.list" title="namespace.list"><code class="xref py py-func docutils literal notranslate"><span class="pre">namespace.list()</span></code></a>,
<a class="reference internal" href="#namespace.search" title="namespace.search"><code class="xref py py-func docutils literal notranslate"><span class="pre">namespace.search()</span></code></a>, and <a class="reference internal" href="#namespace.iterate" title="namespace.iterate"><code class="xref py py-func docutils literal notranslate"><span class="pre">namespace.iterate()</span></code></a> functions described
within this document. This can then be used to filter the various types in IDA
using one of the keywords that are supported by the <a class="reference internal" href="#matching-functions"><span class="std std-ref">Common matcher functions</span></a> for
said type.</p>
<div class="section" id="examples">
<span id="matching-examples"></span><h2>2.3.1. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Some of the matcher classes that are available can be found within the
<a class="reference internal" href="modules/database.html#module-database" title="database"><code class="xref py py-mod docutils literal notranslate"><span class="pre">database</span></code></a> module, the <a class="reference internal" href="modules/structure.html#module-structure" title="structure"><code class="xref py py-mod docutils literal notranslate"><span class="pre">structure</span></code></a> and <a class="reference internal" href="modules/enumeration.html#module-enumeration" title="enumeration"><code class="xref py py-mod docutils literal notranslate"><span class="pre">enumeration</span></code></a>
modules, or the <a class="reference internal" href="modules/segment.html#module-segment" title="segment"><code class="xref py py-mod docutils literal notranslate"><span class="pre">segment</span></code></a> modules. Within the <a class="reference internal" href="modules/database.html#module-database" title="database"><code class="xref py py-mod docutils literal notranslate"><span class="pre">database</span></code></a>
module, most of the <a class="reference internal" href="#matching-functions"><span class="std std-ref">Common matcher functions</span></a> are defined within namespaces
and represent different things such as <code class="xref py py-class docutils literal notranslate"><span class="pre">imports</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">entries</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">names</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">functions</span></code>, etc. It is recommended to review
the help for these modules in order to understand exactly what is provided.</p>
<p>To list all of the structures within the database:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">struc</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
<p>To iterate through all the structures that begin with “my_”:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">struc</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s2">&quot;my_*&quot;</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>To search for a function containing the address 0x401034:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">ea</span><span class="o">=</span><span class="mh">0x401034</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="n">f</span>
</pre></div>
</div>
<p>To iterate through all the structure members that match a regex to
search for unnamed fields:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">st</span> <span class="o">=</span> <span class="n">struc</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">st</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s1">&#39;field_.*$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="common-matcher-functions">
<span id="matching-functions"></span><h2>2.3.2. Common matcher functions<a class="headerlink" href="#common-matcher-functions" title="Permalink to this headline">¶</a></h2>
<p>The 3 basic matcher functions typically have the following prototypes. Each of
these prototypes can take a keyword argument where the key specifies the type.
Typically there are also multicased versions of these functions that take a
single string as its argument. By default this function will be using the
<code class="xref py py-data docutils literal notranslate"><span class="pre">like</span></code> keyword thus making its argument a glob. Please review the
related documentation for the full functionality of each matcher instance.</p>
<dl class="function">
<dt id="namespace.list">
<code class="descclassname">namespace.</code><code class="descname">list</code><span class="sig-paren">(</span><em>**type</em><span class="sig-paren">)</span><a class="headerlink" href="#namespace.list" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will list the matched types within the IDA console. Each row
that is displayed will contain a summary of the type that has matched. This
can then either be double-clicked on, or used to build another filter to
then match with another function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong> – a keyword argument representing the type of match to perform and
what value to match it against</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="namespace.search">
<code class="descclassname">namespace.</code><code class="descname">search</code><span class="sig-paren">(</span><em>**type</em><span class="sig-paren">)</span><a class="headerlink" href="#namespace.search" title="Permalink to this definition">¶</a></dt>
<dd><p>Once a desired type has been determined, this function can then be used to
return the first result that matches. If more than one result is returned,
then this function will warn the user the number of results that matched,
whilst still returning the very first one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong> – a keyword argument representing the type of match to perform and
what value to match it against</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the first item that was matched</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="namespace.iterate">
<code class="descclassname">namespace.</code><code class="descname">iterate</code><span class="sig-paren">(</span><em>**type</em><span class="sig-paren">)</span><a class="headerlink" href="#namespace.iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>When a user wishes to enumerate all of the matches of a particular type, they
will need to use this function. Once given a keyword and value to match with,
this function will iterate through all of the results that are available. These
results will be the core type that the matcher is filtering.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong> – a keyword argument representing the type of match to perform and
what value to match it against</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">an iterator that yields each matched result</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div>
  <h3 class="sidebar">IDA-minsc</h3>
  <p class="sidebar logo">
    <a href="index.html">
      <img class="logo" src="_images/hamster.svg" alt="Logo"/>
    </a>
  </p>
</div>
  <h3 class="sidebar">Navigation</h3>
  <p class="topless">
    Next topic:
    <a href="combinators.html" title="next chapter">2.4. Functional combinators</a>
    <br />
    Previous topic:
    <a href="tagging.html" title="previous chapter">2.2. Tagging and the querying of the tag cache</a>
    <br />
  </p>
  <h3 class="sidebar"><a href="index.html">Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2.3. Matching/Filtering of IDA types</a><ul>
<li><a class="reference internal" href="#examples">2.3.1. Examples</a></li>
<li><a class="reference internal" href="#common-matcher-functions">2.3.2. Common matcher functions</a></li>
</ul>
</li>
</ul>

<h3 class="sidebar">Search</h3>
<div class="searchformwrapper">
  <form class="search" action="search.html" method="get">
    <input type="text" name="q" />
    <input type="submit" value="Go" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<div id="searchbox" role="search">
  <script type="text/javascript">$('#searchbox').show(0);</script>
</div><div class="remove-stupid-js-margin">
 <p>
   <h3 class="sidebar">Indices</h3>
   <ul>
     <li><a href="genindex.html">Index of Functions</a></li>
     <li><a href="py-modindex.html">Index of Modules</a></li>
   </ul>
 </p>
</div>
  <div role="note" aria-label="source link">
    <h3 class="sidebar">This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/matching.rst.txt" rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="combinators.html" title="2.4. Functional combinators"
             >next</a> |</li>
        <li class="right" >
          <a href="tagging.html" title="2.2. Tagging and the querying of the tag cache"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">IDA-minsc  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="concepts.html" >2. Concepts</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2018, Ali Rizvi-Santiago.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>